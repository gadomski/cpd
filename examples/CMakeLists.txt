project(cpd-examples CXX)
cmake_minimum_required(VERSION 2.8.12)
set(DOCOPT_DIR "../vendor/docopt.cpp-af03fa0")

find_package(Cpd REQUIRED)
find_package(PDAL QUIET)

function(cpd_example name)
    set(target ${name}-example)
    add_executable(${target} ${name}.cpp "${DOCOPT_DIR}/docopt.cpp")
    set_target_properties(${target} PROPERTIES OUTPUT_NAME ${name})
    target_link_libraries(${target} PRIVATE Cpd::Library-C++ ${ARGN})
    target_include_directories(${target} PRIVATE "${DOCOPT_DIR}")
    target_compile_options(${target} PRIVATE -std=c++11)
endfunction()

option(WITH_RIGID "Build the rigid registration example" ON)
if(${WITH_RIGID})
    cpd_example(rigid)
endif()

option(WITH_ARTIFICIAL_DISPLACEMENT "Build the artificial displacement example (requires PDAL)" ${PDAL_FOUND})
if(${WITH_ARTIFICIAL_DISPLACEMENT})
    cpd_example(artificial-displacement pdalcpp)
endif()
